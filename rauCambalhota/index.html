<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rau cambalhota</title>
    <link rel="stylesheet" href="style.css" />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
</head>
<body>
    <div class="container">
        <h1>O gato irá dar uma cambalhota, mas aperte com carinho</h1>
        <!-- quando clicar o gato dará uma cambalhota -->
        <img
            src="https://preview.redd.it/here-are-all-my-silly-cats-for-you-people-v0-zxblx3vyw61c1.jpg?width=640&crop=smart&auto=webp&s=c325f04fb81dd6b32bf43e9011ac11f12ba645fc"
            alt="gato"
            id="imagem"
            class="img"
        />
        <!-- a segunda imagem fica no fundo, pois a primeira irá se transformar no gif -->
        <img
            src="https://preview.redd.it/here-are-all-my-silly-cats-for-you-people-v0-zxblx3vyw61c1.jpg?width=640&crop=smart&auto=webp&s=c325f04fb81dd6b32bf43e9011ac11f12ba645fc"
            style="position: absolute; z-index: -1; top: 90px"
            width="250"
            height="250"
            id="imagem2"
            class="img img2"
        />

        <p id="mensagem" class="mensagem"></p>
        <button onclick="virarImagem()" id="btnStart" class="girar">
            Faça o gato girar
        </button>
    </div>

    <script>
        var img = document.getElementById("imagem"); // variavel da imagem
        var mensagemElement = document.getElementById("mensagem"); // elemento para exibir mensagem
        var contadorGiros = 0; // O contador começa zerado
        var maxGiros = Math.floor(Math.random() * 15) + 1; // Número aleatório de giros para explodir
        var gifSrc =
            "https://i.gifer.com/origin/8b/8b1b3a0e7a2ff5d84a2248c70a68df19_w200.gif"; // Variavel do gif da explosão
        var btnStart = document.getElementById("btnStart"); //variavel do botão para girar

        function virarImagem() {
            //Função para fazer o gato girar
            contadorGiros++;

            if (contadorGiros < maxGiros) {
                //caso o contador for menor que o máximo de giros, ele irá rodar
                audioHoly("assets/holymoly.mp3"); //holly molly
                img.style.transform = "rotate(" + 360 * contadorGiros + "deg)";
                mensagemElement.innerText = "Numero de cambalhotas: " + contadorGiros; //exibe o contador de giros na tela
                
                // audio de cambalhota que é tocado quando o contador é menor que o máximo
                function audioHoly(audioFile) {
                    const audio = new Audio(audioFile);
                    audio.volume = 1;
                    audio.currentTime = 1.3;
                    audio.play();

                    // Parar o áudio após 30 segundos
                    setTimeout(() => {
                        audio.pause();
                        audio.currentTime = 0; // Reinicia para o início do áudio
                    }, 3000); // 30000 milissegundos = 30 segundos
                }
                
            } else {
                //quando o contador for maior que o máximo, a imagem irá se transformar no gif de explosão
                img.style.animation = "rotate 1s";
                img.src = gifSrc;
                img.alt = "Gato Explodiu!";
                mensagemElement.textContent = "Não! O gato explodiu!";
                audioExplosao("assets/explosao.mp3"); //explosao audio
                AudioWomp("assets/Womp Womp Sound.mp3"); //Womp Womp

                // Transformar o botão de girar no botão de resetar
                btnStart.innerText = "Reiniciar";
                btnStart.onclick = function() {
                    window.location.reload();
                };

                // Detecta o final da animação
                img.addEventListener(
                    "animationend",
                    function () {
                        img.src =
                            "https://preview.redd.it/here-are-all-my-silly-cats-for-you-people-v0-zxblx3vyw61c1.jpg?width=640&crop=smart&auto=webp&s=c325f04fb81dd6b32bf43e9011ac11f12ba645fc";
                        img.alt = "gato";
                    },

                    { once: true }
                );
            }

            function audioExplosao(audioFile) {
                const audio = new Audio(audioFile);
                audio.volume = 1;
                audio.currentTime = 0;
                audio.play();

                // Parar o áudio após 30 segundos
                setTimeout(() => {
                    audio.pause();
                    audio.currentTime = 0; // Reinicia para o início do áudio
                }, 3000); // 30000 milissegundos = 30 segundos
            }

            function AudioWomp(audioFile) {
                const audioW = new Audio(audioFile);
                audio.volume = 1;
                audio.currentTime = 0;
                audio.play();

                // Parar o áudio após 30 segundos
                setTimeout(() => {
                    audio.pause();
                    audio.currentTime = 0; // Reinicia para o início do áudio
                }, 3000); // 30000 milissegundos = 30 segundos
            }
        }

        
    </script>
</body>
</html>
